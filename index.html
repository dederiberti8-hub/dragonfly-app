<script>
const tg = window.Telegram.WebApp;
tg.expand();

/* ================= FIREBASE CONFIG ================= */

const firebaseConfig = {
  apiKey: "AIzaSyDh9uH5W3Ae_U6KMfqQvcN6YE_mRRWGrAY",
  authDomain: "dragonfly-sys.firebaseapp.com",
  databaseURL: "https://dragonfly-sys-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "dragonfly-sys",
  storageBucket: "dragonfly-sys.firebasestorage.app",
  messagingSenderId: "300472838357",
  appId: "1:300472838357:web:19f9715414a41f37651a5c"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ================= USER ================= */

const userId = tg.initDataUnsafe.user?.id || "dev_user";
const userName = tg.initDataUnsafe.user?.first_name || "Knight";
const startParam = tg.initDataUnsafe.start_param || null;

let totalXP = 0;
let miningXP = 0;
let lastDaily = "";

/* ================= RANK SYSTEM ================= */

const RANKS = [
  { name:"Sabina", min:0, max:5000 },
  { name:"Sentry", min:5000, max:20000 },
  { name:"Knight", min:20000, max:100000 },
  { name:"Commander", min:100000, max:500000 },
  { name:"Dragon Lord", min:500000, max:Infinity }
];

function getRank(xp){
  return RANKS.find(r => xp >= r.min && xp < r.max) || RANKS[0];
}
